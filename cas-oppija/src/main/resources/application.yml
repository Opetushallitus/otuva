# CAS configuration
# https://apereo.github.io/cas/6.5.x/configuration/Configuration-Management.html etc...
cas:
  server:
    name: "http://localhost:8081"
    prefix: "http://localhost:8081/cas-oppija"
  http-web-request:
    cors:
      allow-headers:
        - "*"
      enabled: true
      allow-credentials: true
      allow-methods:
        - "*"
      allow-origin-patterns: [ "http://localhost:[*]", "https://localhost:[*]", "https://testi.apro.tunnistus.fi"]

    header:
      xframe: false
      xss: false
      xcontent: false
      hsts: false
  authn:
    pac4j:
      core:
        lazy-init: true
    accept:
      users:
    errors:
      exceptions:
        - fi.vm.sade.cas.oppija.surrogate.exception.SurrogateNotAllowedException
    authentication-attribute-release:
      only-release:
        - clientName
  tgc:
    secure: false
    path: /cas-oppija
    pin-to-session: false
  warning-cookie:
    secure: false
    path: /cas-oppija
  monitor:
    endpoints:
      endpoint:
        health:
          access: PERMIT
        springWebflow:
          access: PERMIT
  ticket:
    registry:
      cleaner:
        schedule:
          enabled: true
      redis:
        enabled: true
        port: 6379
        host: localhost
        crypto:
          enabled: true
          encryption:
            key: 2luPkLicgX9IjOh_bwxXGQ
          signing:
            key: ext7kseHCJ4VFDE2twpnHJLMOo-FWqD8oRnQMF-bM9npNH0yFweN7I8-mAkIKk6uYh78gYpSQ1TvnIhOReocjw
  webflow:
    session:
      storage: true
      compress: false

management:
  endpoints:
    web:
     exposure:
      include:
       - springWebflow
       - health
  endpoint:
    health:
      enabled: true
    springWebflow:
      enabled: true

# Spring Boot configuration
# https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html


server:
  port: 8080
  servlet:
    context-path: /cas-oppija
    encoding:
      charset: UTF-8
      force: true
      enabled: true
  ssl:
    enabled: false
  forward-headers-strategy: NONE
  tomcat:
    remoteip:
      port-header:
      protocol-header:
      remote-ip-header:
  error:
    include-stacktrace: never

spring:
  session:
    store-type: redis
    redis:
      namespace: spring:session

# Custom configuration

cas.custom.properties:
  suomiFiClientName: suomi.fi
  fakeSuomiFiClientName: fakesuomi.fi

# Read as Properties from Environment

whitelist.regexp: ^https?://.*
host.virkailija: http://localhost:8080

# Valtuudet config
valtuudet.enabled: true
valtuudet.required: true

valtuudet.host: http://localhost:8080
valtuudet.client-id: client    # Who needs this?
valtuudet.api-key: key
valtuudet.oauth-password: password


service-user.username: user
service-user.password: pass

#implementation "org.apereo.cas:cas-server-support-reports:${project.'cas.version'}"
management.endpoint.springWebflow.enabled: true
#cas.monitor.endpoints.endpoint.springWebflow.access: IP_ADDRESS
#cas.monitor.endpoints.endpoint.springWebflow.required-ip-addresses: 127.0.0.1

